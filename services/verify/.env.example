# ========================================
# Restore Verification Service Configuration
# ========================================

# --- REQUIRED VARIABLES ---

# PostgreSQL connection string for restore verification target
# Format: postgresql://username:password@hostname:port/database
# CRITICAL: This MUST be different from your production DATABASE_URL
# Recommended: Use a separate PostgreSQL instance for verification
# Note: The restore drill will create temporary databases on this server
VERIFY_DATABASE_URL=postgresql://postgres:password@verify-server:5432/postgres

# S3-compatible storage endpoint (without bucket name)
S3_ENDPOINT=https://s3.amazonaws.com

# S3 bucket name where backups are stored
S3_BUCKET=my-postgres-backups

# S3 access credentials
S3_ACCESS_KEY_ID=your-access-key-id
S3_SECRET_ACCESS_KEY=your-secret-access-key

# --- OPTIONAL VARIABLES ---

# AWS region (default: us-east-1)
S3_REGION=us-east-1

# Verification interval in seconds (default: 86400 = 24 hours)
# How often to run restore verification drills
# Examples: 3600 (1h), 21600 (6h), 86400 (24h)
VERIFY_INTERVAL=86400

# S3 key prefix where backups are stored (default: postgres-backups)
# Must match the BACKUP_PREFIX used by the backup service
BACKUP_PREFIX=postgres-backups

# Verify the latest backup (default: true)
# Set to false if you want to verify a specific backup
VERIFY_LATEST=true

# Specific backup file to verify (optional)
# Only used if VERIFY_LATEST=false
# Format: backup_YYYYMMDD_HHMMSS.sql.gz
# VERIFY_BACKUP_FILE=backup_20240207_143022.sql.gz

# Custom SQL check to run during verification (optional)
# This SQL statement will be executed against the restored database
# Verification fails if the query returns an error
# Example: SELECT COUNT(*) FROM users WHERE active = true
# VERIFY_SQL=SELECT COUNT(*) FROM critical_table

# Webhook URL for status notifications (optional)
# Sends JSON POST with verification results (success/failure/error)
# Useful for integrating with Slack, Discord, PagerDuty, etc.
# VERIFY_WEBHOOK_URL=https://your-webhook-endpoint.com/notify

# Minimum number of tables expected in restored database (default: 0)
# Verification fails if table count is below this threshold
# Use to detect incomplete or corrupted backups
# MIN_TABLE_COUNT=5
